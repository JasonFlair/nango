"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7779],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),h=r,f=p["".concat(l,".").concat(h)]||p[h]||d[h]||o;return n?a.createElement(f,s(s({ref:t},u),{},{components:n})):a.createElement(f,s({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(7294),r=n(6010);const o="tabItem_Ymn6";function s(e){let{children:t,hidden:n,className:s}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,s),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(7462),r=n(7294),o=n(6010),s=n(2466),i=n(6550),l=n(1980),c=n(7392),u=n(12);function d(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=p(e),[s,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[l,c]=f({queryString:n,groupId:a}),[d,m]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),g=(()=>{const e=l??d;return h({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{g&&i(g)}),[g]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),c(e),m(e)}),[c,m,o]),tabValues:o}}var g=n(2389);const k="tabList__CuJ",b="tabItem_LNqP";function y(e){let{className:t,block:n,selectedValue:i,selectValue:l,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.o5)(),p=e=>{const t=e.currentTarget,n=u.indexOf(t),a=c[n].value;a!==i&&(d(t),l(a))},h=e=>{var t;let n=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const t=u.indexOf(e.currentTarget)+1;n=u[t]??u[0];break}case"ArrowLeft":{const t=u.indexOf(e.currentTarget)-1;n=u[t]??u[u.length-1];break}}null==(t=n)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},c.map((e=>{let{value:t,label:n,attributes:s}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>u.push(e),onKeyDown:h,onClick:p},s,{className:(0,o.Z)("tabs__item",b,null==s?void 0:s.className,{"tabs__item--active":i===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;if(n=Array.isArray(n)?n:[n],t){const e=n.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function N(e){const t=m(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",k)},r.createElement(y,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function w(e){const t=(0,g.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}},5384:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var a=n(7462),r=(n(7294),n(3905)),o=n(4866),s=n(5162);const i={sidebar_label:"Node SDK"},l="Nango Node SDK",c={unversionedId:"reference/node-sdk",id:"reference/node-sdk",title:"Nango Node SDK",description:"The Nango node SDK helps you retrieve access tokens and work with Connections from your backend.",source:"@site/docs/reference/node-sdk.md",sourceDirName:"reference",slug:"/reference/node-sdk",permalink:"/reference/node-sdk",draft:!1,editUrl:"https://github.com/nangohq/nango/tree/master/docs/docs/reference/node-sdk.md",tags:[],version:"current",frontMatter:{sidebar_label:"Node SDK"},sidebar:"nango",previous:{title:"Frontend SDK",permalink:"/reference/frontend-sdk"},next:{title:"Connections API",permalink:"/reference/connections-api"}},u={},d=[{value:"Installing &amp; instantiating the node SDK",id:"installing--instantiating-the-node-sdk",level:2},{value:"Getting the current access token for a Connection",id:"getting-the-current-access-token-for-a-connection",level:2},{value:"Getting Connection Details &amp; Metadata",id:"connectionDetails",level:2},{value:"Accessing the raw token response",id:"accessing-the-raw-token-response",level:2},{value:"Getting a list of all Connections",id:"getting-a-list-of-all-connections",level:2}],p={toc:d};function h(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"nango-node-sdk"},"Nango Node SDK"),(0,r.kt)("p",null,"The Nango node SDK helps you retrieve access tokens and work with ",(0,r.kt)("a",{parentName:"p",href:"/reference/core-concepts#connections"},"Connections")," from your backend."),(0,r.kt)("h2",{id:"installing--instantiating-the-node-sdk"},"Installing & instantiating the node SDK"),(0,r.kt)("p",null,"The node SDK is ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@nangohq/node"},"available on NPM")," as ",(0,r.kt)("inlineCode",{parentName:"p"},"@nangohq/node"),", install it with your favorite package manager:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm i -S @nangohq/node\n")),(0,r.kt)("p",null,"How you instantiate the SDK depends on your Nango deployment method:"),(0,r.kt)(o.Z,{groupId:"deployment",queryString:!0,mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"cloud",label:"Nango Cloud",mdxType:"TabItem"},(0,r.kt)("p",null,"You will need the ",(0,r.kt)("inlineCode",{parentName:"p"},"Secret Key")," from your ",(0,r.kt)("a",{parentName:"p",href:"https://app.nango.dev/"},"Dashboard"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { Nango } from '@nangohq/node';\n\nlet nango = new Nango({ secretKey: '<SECRET-KEY>' });\n"))),(0,r.kt)(s.Z,{value:"localhost",label:"Localhost",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { Nango } from '@nangohq/node';\n\nlet nango = new Nango({ host: 'http://localhost:3003' });\n"))),(0,r.kt)(s.Z,{value:"self-hosted",label:"Self-hosted",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { Nango } from '@nangohq/node';\n\nlet nango = new Nango({ host: '<NANGO-HOST-AND-PORT>' });\n")))),(0,r.kt)("p",null,"If you are using TypeScript you will notice that the node SDK ships with TypeScript types."),(0,r.kt)("h2",{id:"getting-the-current-access-token-for-a-connection"},"Getting the current access token for a Connection"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"let access_token = await nango.getToken('<PROVIDER-CONFIG-KEY>', '<CONNECTION-ID>');\nconsole.log(access_token); // For OAuth 2 APIs this will print \"axb_dijifoweif32qwij923jfo3\" or similar\n")),(0,r.kt)("p",null,"If you are not familiar with the Provider Config Key and Connection Id parameters please take a look at the ",(0,r.kt)("a",{parentName:"p",href:"/reference/core-concepts"},"Core Concepts")," page."),(0,r.kt)("p",null,"This is the recommended way to retrieve an access token to make an API call."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Response for OAuth 1 tokens"),(0,r.kt)("br",{parentName:"p"}),"\n","If the access token stored in Nango is for an OAuth 1 provider (there are very very few left, the most prominent ones are Twitter and Trello) the response is an object instead of a string:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n    oAuthToken: "efjweiofoj34iji2io43j",\n    oAuthTokenSecret: "dijdwojfwef89329834hf3ohf2o3i8"\n}\n')),(0,r.kt)("p",null,"This is because OAuth 1 requires you to cryptographically sign every HTTP request, which requires both an access token and an (OAuth 1 specific) access token secret."),(0,r.kt)("admonition",{title:"Keep your access tokens fresh and don't cache them!",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"When you call this method the Nango server will check whether the access token needs to be refreshed, and, if needed, refresh it before returning it to you. This typically changes the access token."),(0,r.kt)("p",{parentName:"admonition"},"Because of this it is important that you always use this method to get the latest access token from Nango just before making an API request. If you cache the access token on your end you risk working with an expired or revoked access token and your API call will fail!"),(0,r.kt)("p",{parentName:"admonition"},"We take great care to make sure that this call to get an access token is blazingly fast, so retrieving it fresh will not slow down your API requests.")),(0,r.kt)("h2",{id:"connectionDetails"},"Getting Connection Details & Metadata"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let connectionDetails = await nango.getConnection('<PROVIDER-CONFIG-KEY>', '<CONNECTION-ID>');\n")),(0,r.kt)("p",null,"This retrieves the full Connection object from Nango, which looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"{\nid: 18393,                                  // Nango internal connection id\ncreated_at: '2023-03-08T09:43:03.725Z',     // Creation timestamp\nupdated_at: '2023-03-08T09:43:03.725Z',     // Last updated timestamp (e.g. last token refresh)\nprovider_config_key: 'github',              // <PROVIDER-CONFIG-KEY>\nconnection_id: '1',                         // <CONNECTION-ID>\ncredentials: {\n    type: 'OAUTH2',                         // OAUTH2 or OAUTH1\n    access_token: 'gho_tsXLG73f....',       // The current access token (refreshed if needed)\n    refresh_token: 'gho_fjofu84u9....',     // Refresh token (if available, otherwise missing)\n    expires_at: '2024-03-08T09:43:03.725Z', // Expiration date of access token (only if refresh token is present, otherwise missing)\n    raw: {                                  // Raw token response from the OAuth provider: Contents vary!\n        access_token: 'gho_tsXLG73f....',\n        token_type: 'bearer',\n        scope: 'public_repo,user'\n    }\n},\nconnection_config: {},                      // Additional configuration, see Frontend SDK reference\naccount_id: 0,                              // ID of your Nango account (Nango Cloud only)\nmetadata: {}                                // Structured metadata retrieved by Nango\n}\n")),(0,r.kt)("p",null,"The metadata field contains ",(0,r.kt)("a",{parentName:"p",href:"/reference/core-concepts#metadata"},"structured metadata"),", which Nango obtained from the OAuth flow. This varies by provider and is documented on the provider's Nango documentation page."),(0,r.kt)("h2",{id:"accessing-the-raw-token-response"},"Accessing the raw token response"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let rawTokenResponse = await nango.getRawTokenResponse('<PROVIDER-CONFIG-KEY>', '<CONNECTION-ID>');\n")),(0,r.kt)("p",null,"A fast access method for obtaining the raw token response, as returned by the OAuth provider, for a given connection. This is equivalent to getting the full connection details and then reading ",(0,r.kt)("inlineCode",{parentName:"p"},"fullDetails.credentials.raw"),"."),(0,r.kt)("h2",{id:"getting-a-list-of-all-connections"},"Getting a list of all Connections"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"let connectionsList = await nango.listConnections();\n")),(0,r.kt)("p",null,"Returns a list of minimalistic Connection objects. This can be helpful if you need to check whether a user has setup a specific integration. Note that the list does not contain any access credentials and fetching it also does not refresh the access tokens of any Connections."),(0,r.kt)("p",null,"The return value looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"{\n    connections: [\n        {\n            connection_id: '<CONNECTION-ID-1>',\n            provider: '<PROVIDER-CONFIG-KEY-1>',\n            created: '2023-03-08T09:43:03.725Z'\n        },\n        {\n            //....\n        }\n        // Additional objects like the one above\n    ];\n}\n")))}h.isMDXComponent=!0}}]);